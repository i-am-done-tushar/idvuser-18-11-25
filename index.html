<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>USER FRONTEND</title>
    <!-- Preconfigure OpenCV.js wasm loader to fetch from the same CDN path -->
    <script>
      // Ensure Emscripten module config exists before loading OpenCV
      window.Module = window.Module || {};
      // Help OpenCV find its WASM and worker files when served from CDN
      window.Module.locateFile = function(file) {
        return 'https://docs.opencv.org/4.x/' + file;
      };
      // Global readiness flag for app code
      window.__cvReady = false;
      window.Module.onRuntimeInitialized = function() {
        try { window.__cvReady = true; } catch {}
        try { console.log('[OpenCV] onRuntimeInitialized (global)'); } catch {}
      };
    </script>
    <!-- Load OpenCV.js early and globally (blocking) so it's ready before the app runs -->
    <script src="https://docs.opencv.org/4.x/opencv.js" crossorigin="anonymous"></script>
    <script>
      // Fallback: mark ready if cv is already initialized by the time this runs
      (function(){
        try {
          if (window.cv && window.cv.Mat && !window.__cvReady) {
            window.__cvReady = true;
            console.log('[OpenCV] Ready (cv.Mat present)');
          }
        } catch {}
      })();
    </script>
  </head>

  <body>
    <div id="root"></div>

    <script type="module" src="/client/App.tsx"></script>

  </body>
</html>

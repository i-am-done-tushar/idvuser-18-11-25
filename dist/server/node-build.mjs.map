{"version":3,"file":"node-build.mjs","sources":["../../server/routes/demo.ts","../../server/routes/templates.ts","../../server/routes/shortcode.ts","../../server/routes/templateVersionDirect.ts","../../server/index.ts","../../server/node-build.ts"],"sourcesContent":["import { RequestHandler } from \"express\";\r\nimport { DemoResponse } from \"@shared/api\";\r\n\r\nexport const handleDemo: RequestHandler = (req, res) => {\r\n  const response: DemoResponse = {\r\n    message: \"Hello from Express server\",\r\n  };\r\n  res.status(200).json(response);\r\n};\r\n","import { RequestHandler } from \"express\";\r\nimport { TemplateResponse } from \"@shared/templates\";\r\n\r\n// Mock template data based on the API response example\r\nconst mockTemplate: TemplateResponse = {\r\n  id: 1,\r\n  name: \"Identity Verification Template\",\r\n  description: \"Standard identity verification process\",\r\n  createdBy: 1,\r\n  createdByName: \"System Admin\",\r\n  createdByEmail: \"admin@idv.local\",\r\n  updatedBy: null,\r\n  updatedByName: \"\",\r\n  updatedByEmail: \"\",\r\n  createdAt: \"2025-01-14T11:28:19.173459+00:00\",\r\n  updatedAt: null,\r\n  versions: [\r\n    {\r\n      versionId: 2,\r\n      templateId: 1,\r\n      versionNumber: 2,\r\n      isActive: true,\r\n      enforceRekyc: true,\r\n      rekycDeadline: \"2025-12-31\",\r\n      changeSummary: \"Updated personal information fields\",\r\n      isDeleted: false,\r\n      createdBy: 1,\r\n      createdByName: \"System Admin\",\r\n      createdByEmail: \"admin@idv.local\",\r\n      updatedBy: null,\r\n      updatedByName: \"\",\r\n      updatedByEmail: \"\",\r\n      createdAt: \"2025-01-14T12:11:23.594132\",\r\n      updatedAt: \"2025-01-14T12:11:23.594132\",\r\n      rowVersionBase64: \"CN3ztexinqA=\",\r\n      sections: [\r\n        {\r\n          id: 5,\r\n          templateVersionId: 2,\r\n          name: \"Personal Information\",\r\n          description: \"Basic personal information for identity verification\",\r\n          orderIndex: 1,\r\n          sectionType: \"personalInformation\",\r\n          isActive: true,\r\n          createdBy: 1,\r\n          createdByName: \"System Admin\",\r\n          createdByEmail: \"admin@idv.local\",\r\n          updatedBy: null,\r\n          updatedByName: null,\r\n          updatedByEmail: null,\r\n          createdAt: \"2025-01-14T12:11:23.778971+00:00\",\r\n          updatedAt: null,\r\n          fieldMappings: [\r\n            {\r\n              id: 5,\r\n              templateSectionId: 5,\r\n              structure: {\r\n                fields: [\r\n                  { name: \"firstName\", type: \"string\", required: true },\r\n                  { name: \"lastName\", type: \"string\", required: true },\r\n                  { name: \"middleName\", type: \"string\", required: false },\r\n                  { name: \"dateOfBirth\", type: \"date\", required: true },\r\n                  { name: \"email\", type: \"email\", required: true },\r\n                  { name: \"phoneNumber\", type: \"string\", required: true },\r\n                  { name: \"gender\", type: \"enum\", required: false, options: [\"Male\", \"Female\", \"Non-Binary\", \"Prefer Not To Say\"] },\r\n                  { name: \"address\", type: \"string\", required: true },\r\n                  { name: \"city\", type: \"string\", required: true },\r\n                  { name: \"postalCode\", type: \"string\", required: true }\r\n                ]\r\n              },\r\n              captureAllowed: false,\r\n              uploadAllowed: false\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          id: 4,\r\n          templateVersionId: 2,\r\n          name: \"Identity Document\",\r\n          description: \"Government-issued identification document verification\",\r\n          orderIndex: 2,\r\n          sectionType: \"documents\",\r\n          isActive: true,\r\n          createdBy: 1,\r\n          createdByName: \"System Admin\",\r\n          createdByEmail: \"admin@idv.local\",\r\n          updatedBy: null,\r\n          updatedByName: null,\r\n          updatedByEmail: null,\r\n          createdAt: \"2025-01-14T12:11:23.718873+00:00\",\r\n          updatedAt: null,\r\n          fieldMappings: [\r\n            {\r\n              id: 4,\r\n              templateSectionId: 4,\r\n              structure: {\r\n                fields: [\r\n                  { name: \"documentType\", type: \"enum\", required: true, options: [\"passport\", \"driversLicense\", \"nationalId\"] },\r\n                  { name: \"documentNumber\", type: \"string\", required: true },\r\n                  { name: \"expiryDate\", type: \"date\", required: false }\r\n                ]\r\n              },\r\n              captureAllowed: true,\r\n              uploadAllowed: true\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          id: 6,\r\n          templateVersionId: 2,\r\n          name: \"Capture Selfie\",\r\n          description: \"Live selfie capture for biometric verification\",\r\n          orderIndex: 3,\r\n          sectionType: \"biometrics\",\r\n          isActive: true,\r\n          createdBy: 1,\r\n          createdByName: \"System Admin\",\r\n          createdByEmail: \"admin@idv.local\",\r\n          updatedBy: null,\r\n          updatedByName: null,\r\n          updatedByEmail: null,\r\n          createdAt: \"2025-01-14T12:11:23.784691+00:00\",\r\n          updatedAt: null,\r\n          fieldMappings: [\r\n            {\r\n              id: 6,\r\n              templateSectionId: 6,\r\n              structure: {},\r\n              captureAllowed: true,\r\n              uploadAllowed: false\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n};\r\n\r\nexport const handleGetTemplate: RequestHandler = (req, res) => {\r\n  const { id } = req.params;\r\n  \r\n  // In a real app, you would fetch from database using the id\r\n  // For now, return the mock template for any ID\r\n  if (!id || isNaN(Number(id))) {\r\n    return res.status(400).json({ error: \"Invalid template ID\" });\r\n  }\r\n\r\n  // Simulate template with the requested ID\r\n  const template = { ...mockTemplate, id: Number(id) };\r\n  \r\n  res.json(template);\r\n};\r\n","import { RequestHandler } from \"express\";\r\nimport { ShortCodeResolveResponse, TemplateVersionResponse } from \"@shared/api\";\r\n\r\n// Hardcoded API base URL - you can move this to environment variables later\r\nconst API_BASE_URL = \"http://10.10.2.133:8080\";\r\n// const API_BASE_URL = \"http://localhost:5027\";\r\n\r\n\r\nexport const handleResolveShortCode: RequestHandler = async (req, res) => {\r\n  const { shortCode } = req.params;\r\n  \r\n  if (!shortCode) {\r\n    return res.status(400).json({ error: \"Short code is required\" });\r\n  }\r\n\r\n  try {\r\n    // Make request to resolve shortcode\r\n    const response = await fetch(`${API_BASE_URL}/api/templates-link-generation/resolve/${shortCode}`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Accept': 'application/json'\r\n      }\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to resolve shortcode: ${response.status}`);\r\n    }\r\n\r\n    const data: ShortCodeResolveResponse = await response.json();\r\n    res.json(data);\r\n  } catch (error) {\r\n    console.error('Error resolving shortcode:', error);\r\n    res.status(500).json({ error: 'Failed to resolve shortcode' });\r\n  }\r\n};\r\n\r\nexport const handleGetTemplateVersion: RequestHandler = async (req, res) => {\r\n  const { versionId } = req.params;\r\n  \r\n  if (!versionId) {\r\n    return res.status(400).json({ error: \"Version ID is required\" });\r\n  }\r\n\r\n  try {\r\n    // Make request to get template version\r\n    const response = await fetch(`${API_BASE_URL}/api/TemplateVersion/${versionId}`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Accept': 'application/json'\r\n      }\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to get template version: ${response.status}`);\r\n    }\r\n\r\n    const data: TemplateVersionResponse = await response.json();\r\n    res.json(data);\r\n  } catch (error) {\r\n    console.error('Error getting template version:', error);\r\n    res.status(500).json({ error: 'Failed to get template version' });\r\n  }\r\n};","import { RequestHandler } from \"express\";\r\nimport { TemplateVersionResponse } from \"@shared/api\";\r\n\r\n// Mock template version data that matches the expected structure\r\nconst mockTemplateVersion: TemplateVersionResponse = {\r\n  versionId: 2,\r\n  templateId: 2,\r\n  versionNumber: 1,\r\n  isActive: true,\r\n  enforceRekyc: false,\r\n  rekycDeadline: null,\r\n  changeSummary: null,\r\n  isDeleted: false,\r\n  createdBy: 1,\r\n  createdByName: \"System Admin\",\r\n  createdByEmail: \"admin@idv.local\",\r\n  updatedBy: null,\r\n  updatedByName: null,\r\n  updatedByEmail: null,\r\n  createdAt: \"2025-09-22T12:47:34.652137\",\r\n  updatedAt: \"2025-09-22T12:47:34.65219\",\r\n  rowVersionBase64: \"CN36BE2wYVI=\",\r\n  sections: [\r\n    {\r\n      id: 4,\r\n      templateVersionId: 2,\r\n      name: \"Personal Information\",\r\n      description: \"Please provide your basic personal information to begin the identity verification process.\",\r\n      orderIndex: 1,\r\n      sectionType: \"personalInformation\",\r\n      isActive: true,\r\n      createdBy: 1,\r\n      createdByName: \"System Admin\",\r\n      createdByEmail: \"admin@idv.local\",\r\n      updatedBy: null,\r\n      updatedByName: null,\r\n      updatedByEmail: null,\r\n      createdAt: \"2025-09-22T12:47:34.67911+00:00\",\r\n      updatedAt: null,\r\n      fieldMappings: [\r\n        {\r\n          id: 4,\r\n          templateSectionId: 4,\r\n          structure: {\r\n            fields: [\r\n              { name: \"firstName\", type: \"string\", required: true },\r\n              { name: \"lastName\", type: \"string\", required: true },\r\n              { name: \"middleName\", type: \"string\", required: false },\r\n              { name: \"dateOfBirth\", type: \"date\", required: true },\r\n              { name: \"email\", type: \"email\", required: true },\r\n              { name: \"phoneNumber\", type: \"string\", required: true },\r\n              { name: \"gender\", type: \"enum\", required: false },\r\n              { name: \"address\", type: \"string\", required: true },\r\n              { name: \"city\", type: \"string\", required: true },\r\n              { name: \"postalCode\", type: \"string\", required: true }\r\n            ]\r\n          },\r\n          captureAllowed: false,\r\n          uploadAllowed: false\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: 5,\r\n      templateVersionId: 2,\r\n      name: \"Document Verification\",\r\n      description: \"Choose a valid government-issued ID (like a passport, driver's license, or national ID) and upload a clear photo of it.\",\r\n      orderIndex: 2,\r\n      sectionType: \"documents\",\r\n      isActive: true,\r\n      createdBy: 1,\r\n      createdByName: \"System Admin\",\r\n      createdByEmail: \"admin@idv.local\",\r\n      updatedBy: null,\r\n      updatedByName: null,\r\n      updatedByEmail: null,\r\n      createdAt: \"2025-09-22T12:47:34.709319+00:00\",\r\n      updatedAt: null,\r\n      fieldMappings: [\r\n        {\r\n          id: 5,\r\n          templateSectionId: 5,\r\n          structure: {},\r\n          captureAllowed: false,\r\n          uploadAllowed: false\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: 6,\r\n      templateVersionId: 2,\r\n      name: \"Biometric Verification\",\r\n      description: \"Take a live selfie to confirm you are the person in the ID document. Make sure you're in a well-lit area and your face is clearly visible.\",\r\n      orderIndex: 3,\r\n      sectionType: \"biometrics\",\r\n      isActive: true,\r\n      createdBy: 1,\r\n      createdByName: \"System Admin\",\r\n      createdByEmail: \"admin@idv.local\",\r\n      updatedBy: null,\r\n      updatedByName: null,\r\n      updatedByEmail: null,\r\n      createdAt: \"2025-09-22T12:47:34.717199+00:00\",\r\n      updatedAt: null,\r\n      fieldMappings: [\r\n        {\r\n          id: 6,\r\n          templateSectionId: 6,\r\n          structure: {},\r\n          captureAllowed: false,\r\n          uploadAllowed: false\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  invitees: [\r\n    {\r\n      id: 1,\r\n      name: \"System Admin\",\r\n      email: \"admin@idv.local\",\r\n      status: \"INVITED\"\r\n    }\r\n  ]\r\n};\r\n\r\n// Mock with only 2 sections (to test dynamic filtering)\r\nconst mockTemplateVersion2Sections: TemplateVersionResponse = {\r\n  ...mockTemplateVersion,\r\n  versionId: 3,\r\n  sections: [\r\n    {\r\n      ...mockTemplateVersion.sections[0], // Personal Information\r\n      id: 7\r\n    },\r\n    {\r\n      ...mockTemplateVersion.sections[2], // Biometrics only\r\n      id: 8,\r\n      orderIndex: 2\r\n    }\r\n  ]\r\n};\r\n\r\n// Mock with sections in different order (to test ordering)\r\nconst mockTemplateVersionDifferentOrder: TemplateVersionResponse = {\r\n  ...mockTemplateVersion,\r\n  versionId: 4,\r\n  sections: [\r\n    {\r\n      ...mockTemplateVersion.sections[2], // Biometrics first\r\n      orderIndex: 1\r\n    },\r\n    {\r\n      ...mockTemplateVersion.sections[0], // Personal Info second\r\n      orderIndex: 2\r\n    },\r\n    {\r\n      ...mockTemplateVersion.sections[1], // Documents third\r\n      orderIndex: 3\r\n    }\r\n  ]\r\n};\r\n\r\nexport const handleGetTemplateVersionDirect: RequestHandler = (req, res) => {\r\n  const { versionId } = req.params;\r\n  \r\n  if (!versionId || isNaN(Number(versionId))) {\r\n    return res.status(400).json({ error: \"Invalid version ID\" });\r\n  }\r\n\r\n  const id = Number(versionId);\r\n  \r\n  // Return different mock data based on ID to test dynamic behavior\r\n  switch (id) {\r\n    case 1:\r\n      res.json(mockTemplateVersion);\r\n      break;\r\n    case 2:\r\n      res.json(mockTemplateVersion2Sections);\r\n      break;\r\n    case 3:\r\n      res.json(mockTemplateVersionDifferentOrder);\r\n      break;\r\n    default:\r\n      res.json(mockTemplateVersion);\r\n      break;\r\n  }\r\n};","import \"dotenv/config\";\r\nimport express from \"express\";\r\nimport cors from \"cors\";\r\nimport { handleDemo } from \"./routes/demo\";\r\nimport { handleGetTemplate } from \"./routes/templates\";\r\nimport { handleResolveShortCode } from \"./routes/shortcode\";\r\nimport { handleGetTemplateVersionDirect } from \"./routes/templateVersionDirect\";\r\n\r\nexport function createServer() {\r\n  const app = express();\r\n\r\n  // Middleware\r\n  app.use(cors());\r\n  app.use(express.json());\r\n  app.use(express.urlencoded({ extended: true }));\r\n\r\n  // Example API routes\r\n  app.get(\"/api/ping\", (_req, res) => {\r\n    const ping = process.env.PING_MESSAGE ?? \"ping\";\r\n    res.json({ message: ping });\r\n  });\r\n\r\n  app.get(\"/api/demo\", handleDemo);\r\n\r\n  // Template API route\r\n  app.get(\"/api/templates/:id\", handleGetTemplate);\r\n\r\n  // Shortcode resolution routes (both formats for flexibility)\r\n  app.get(\r\n    \"/api/templates-link-generation/resolve/:shortCode\",\r\n    handleResolveShortCode,\r\n  );\r\n  \r\n  // Alternative endpoint format for query parameter\r\n  app.get(\"/api/links/resolve\", (req, res, next) => {\r\n    const shortCode = req.query.shortCode as string;\r\n    if (!shortCode) {\r\n      return res.status(400).json({ error: \"shortCode query parameter is required\" });\r\n    }\r\n    // Create a new request object with the shortCode in params\r\n    const modifiedReq = { ...req, params: { ...req.params, shortCode } };\r\n    handleResolveShortCode(modifiedReq as any, res, next);\r\n  });\r\n  \r\n  app.get(\"/api/TemplateVersion/:versionId\", handleGetTemplateVersionDirect);\r\n\r\n  return app;\r\n}\r\n","import path from \"path\";\r\nimport { createServer } from \"./index\";\r\nimport * as express from \"express\";\r\n\r\nconst app = createServer();\r\nconst port = process.env.PORT || 3000;\r\n\r\n// In production, serve the built SPA files\r\nconst __dirname = import.meta.dirname;\r\nconst distPath = path.join(__dirname, \"../spa\");\r\n\r\n// Serve static files\r\napp.use(express.static(distPath));\r\n\r\n// Handle React Router - serve index.html for all non-API routes\r\napp.get(\"*\", (req, res) => {\r\n  // Don't serve index.html for API routes\r\n  if (req.path.startsWith(\"/api/\") || req.path.startsWith(\"/health\")) {\r\n    return res.status(404).json({ error: \"API endpoint not found\" });\r\n  }\r\n\r\n  res.sendFile(path.join(distPath, \"index.html\"));\r\n});\r\n\r\napp.listen(port, () => {\r\n  console.log(`ðŸš€ Fusion Starter server running on port ${port}`);\r\n  console.log(`ðŸ“± Frontend: http://localhost:${port}`);\r\n  console.log(`ðŸ”§ API: http://localhost:${port}/api`);\r\n});\r\n\r\n// Graceful shutdown\r\nprocess.on(\"SIGTERM\", () => {\r\n  console.log(\"ðŸ›‘ Received SIGTERM, shutting down gracefully\");\r\n  process.exit(0);\r\n});\r\n\r\nprocess.on(\"SIGINT\", () => {\r\n  console.log(\"ðŸ›‘ Received SIGINT, shutting down gracefully\");\r\n  process.exit(0);\r\n});\r\n"],"names":["app","express"],"mappings":"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"}